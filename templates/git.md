# Git 利用ガイド

## このドキュメントについて

git および GitHub に関連するガイドラインです。

## このドキュメントが必要な理由

とくにコミット粒度とコミットメッセージは、レビューのしやすさやあとでログを見るときの見やすさに影響があるので、できるだけ本ガイドに従ってください。

## 1. ブランチ戦略

以下のルールで運用します。

- main → 本番デプロイ可能なブランチ
  - 原則的には develop → main へマージ
- develop → 開発ブランチ
- feat, fix, chore, etc. → トピックブランチ（develop から切る）
- story → 一度に複数の機能をまとめてリリースしたい場合に使用するトピックの集合
  - トピックブランチは story ブランチから切り、プルリクエストは story ブランチに向けて作成する
- epic → 一度に複数の機能をまとめてリリースしたい場合に使用する story ブランチの集合
  - story ブランチを epic ブランチから切り、story ブランチがリリース可能になったらプルリクエストを epic ブランチに向けて作成する 
- hotfix → ホットフィックス（緊急修正）ブランチ（main から切る）

## 2. コミット粒度

1. コミットログ1行（あるいはフッターを含めて3行程度）で変更点を説明できるくらいの粒度にしてください。

## 3. コミットメッセージ

### 3.1. 書式

```
type： description

footer（任意）
```

### 3.2. type

1. 基本的にこちらのガイドに記載の命名に従ってください。

> fix: や feat: 以外の 型 も許されています。たとえば @commitlint/config-conventional (これは Angular の規約 が基になっています) は build:, chore:, ci:,docs:, style:, refactor:, perf:, test:, などを推奨しています。

[Conventional Commits](https://www.conventionalcommits.org/ja/v1.0.0/)

> [!CAUTION]
> ここにないものはその都度 Slack などで協議して、導入するようにしてください。

### 3.3. description

1. できるだけ1行で変更点が分かるようにしてください
2. 1行でどのような変更を加えたのかわからないようなメッセージは書かないでください
3. 補足説明が必要な場合はフッターを利用してください

例）

```
// Good
fix: お問い合わせ時、管理者宛のメールはbccではなくtoで送信するように修正

管理者のメールアドレスがアドレス欄に表示されるように

// Bad
fix: 修正
```

## 4. マージオプション

マージコミットを残すようにしたいので（diff や revert がしやすくなるので）、

1. GitHub 上でマージする際には原則的には「Create merge commit」を選択してください
2. ローカルでマージする際は `--no-ff` オプションを指定してください

## 5. 生存期間の長いトピックブランチについて

トピックブランチはできるだけ速やかにベースブランチにマージするのが望ましいですが、リリースタイミングなどによって長期間（2週間を超えるくらいが目安）生存することがあります。その場合、

1. 適度なタイミングでベースブランチをマージしてください（コンフリクトが多くなるのを防ぐため）